<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title> CPS 449: Erich Jaster's Home Page</title>
        <script src="https://udayton-cloud.bitbucket.io/clock.js"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" 
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" 
            crossorigin="anonymous"></script>
                <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
        <style>
            body {
                font: 20px Montserrat, sans-serif;
                line-height: 1.8;
                color: #224b22;
            }
            p {font-size: 16px;}
            .margin {margin-bottom: 45px;}
            .bg-1 { 
                background-color: #228B22;
                color: #d1ffd1;
            }
            .bg-2 { 
                background-color: #224b22;
                color: #d1ffd1;
            }
            .bg-3 { 
                background-color: #d1ffd1;
                color: #224b22;
            }
            .bg-4 { 
                background-color: #0a160a;
                color: #d1ffd1;
            }
            .container-fluid {
                padding-top: 70px;
                padding-bottom: 70px;
            }
            .navbar {
                padding-top: 15px;
                padding-bottom: 15px;
                border: 0;
                border-radius: 0;
                margin-bottom: 0;
                font-size: 12px;
                letter-spacing: 5px;
            }
            .navbar-nav  li a:hover {
                color: #228B22 !important;
            }
            .button {
                background-color: #228B22;
                border: none;
                color: white;
                padding: 5px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 12px;
                margin: 4px 2px;
                cursor: pointer;
            }

            .round {border-radius: 8px;}
            #response {background-color: #baffba;}
            #vueResponse {background-color: #baffba;}
            #trivia {background-color: #baffba;}
            #triviaAnswers {background-color: #baffba;}
            #triviaAnswer {background-color: #baffba;}
            #cat {background-color: #224b22;}
            #catInfo {background-color: #224b22;}
            #chatBox {
                background-color: #224b22;
                height: 250px;
                text-align: center;
                overflow-y: auto;
                border: 3px solid #224b22;
                padding: 10px;
            }

            .message {
                color: white;
                padding: 8px;
                margin: 5px;
                border-radius: 10px;
                max-width: 80%;
            }

            .user-message {
                background-color: #228B22;
                color: #baffba;
                text-align: right;
                align-self: flex-end;
            }

            .bot-message {
                background-color: #baffba;
                color: #224b22;
                text-align: left;
                align-self: flex-start;
            }

            .waiting {
                color: #baffba;
                font-style: italic;
            }
            
        </style>
    </head>

    <body>

        <!-- Navbar -->
        <nav class="navbar navbar-default">
            <div class="container">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>                        
                </button>
                <a class="navbar-brand" href="https://cavekitty16.github.io/">Erich Jaster</a>
              </div>
              <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://www.linkedin.com/in/erich-jaster/">Linkedin</a></li>
                  <li><a href="https://erich-jaster.itch.io/">itch.io</a></li>
                  <li><a href="https://github.com/Cavekitty16">Github</a></li>
                </ul>
              </div>
            </div>
        </nav>

        <!-- Introduction -->
        <div class="container-fluid bg-1 text-center">
            <h1 class="margin">Erich Jaster</h1>
            <img src="Portrait.jpg" class="img-responsive img-circle margin" style="display:inline" alt="Portrait" width="350" height="350">
            <h3>Individual Project 1</h3>
            <div id="email" onclick="showhideEmail()">Show my email</div>
                <script src="email.js"></script>
        </div>

        
        <!-- Fun Stuff -->
        <div class="container-fluid bg-3 text-center">    
            <div class="row">
            <div class="col-sm-4">
                <p>Time</p>
                <canvas id="analog-clock" width="150" height="150" style="background-color:#d1ffd1"></canvas>
                <div id="mydiv"
                        onclick="document.getElementById('mydiv').innerHTML= 'Clicked time: ' + Date()">
                        Click here for current time</div>
                    <div id="digit-clock"></div>
                <script>
                    var canvas = document.getElementById("analog-clock");
                        var ctx = canvas.getContext("2d");
                        var radius = canvas.height / 2;
                        ctx.translate(radius, radius);
                        radius = radius * 0.90;
                        setInterval(drawClock, 1000);

                        function drawClock(){
                            drawFace(ctx, radius);
                            drawNumbers(ctx, radius);
                            drawTime(ctx, radius);
                        }
                    function displayTime() {
                        document.getElementById('digit-clock').innerHTML = "Current time: " + new Date();
                    }
                    setInterval(displayTime, 500);
                </script>
            </div>

            <div class="col-sm-4"> 
                <p>Trivia</p>
                <form>
                    <input class="button round" type="button" value="Trivia?" onclick="triviaAPIfetch()">
                    <div id="trivia"></div>
                    <div id="triviaAnswers"></div>
                    <div id="guessContainer" style="display: none;">
                        Your Guess: <input name="guess" onkeyup="console.log('You have pressed a key')" id="guess">
                        <input class="button round" type="button" value="Guess?" onclick="triviaGuess()">
                    </div>
                    <div id="triviaAnswer"></div>
                </form>
                <script>
                    let correctAnswer = "";
                    let answers = [];
                    async function triviaAPIfetch(){
                        const triviaAPI_res = await
                        fetch("https://opentdb.com/api.php?amount=1&difficulty=easy");
                        const result = await triviaAPI_res.json();
                        $("#trivia").html(result.results[0].question)
                        //Get correct answers and wrong answers put into array, mix then print
                        correctAnswer = result.results[0].correct_answer;
                        incorrectAnswers = result.results[0].incorrect_answers;
                        answers = [correctAnswer].concat(incorrectAnswers);
                        shuffleArray(answers);
                        $("#trivia").html(result.results[0].question)
                        $("#triviaAnswers").html(""); 
                        answers.forEach(answer => {
                        $("#triviaAnswers").append(`<div style="margin: 10px 0;">${answer}</div>`);
                        });
                        document.getElementById("guessContainer").style.display = "block";
                    }
                    function shuffleArray(array) {
                        for (let i = array.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [array[i], array[j]] = [array[j], array[i]]; // Swap elements
                        }
                    }
                    function triviaGuess(){
                        var input = document.getElementById("guess").value;
                        if (input.toLowerCase() === correctAnswer.toLowerCase()){
                            $("#triviaAnswer").html("Correct!")
                        } else {
                            $("#triviaAnswer").html("Sorry, The correct answer was: " + correctAnswer)
                        }
                    }
                </script>
            </div>
        </div>

        <!-- Image Generator -->
        <div class="container-fluid bg-2 text-center">
            <h3 class="margin">Image Generator</h3>
            <input class="button round" type="button" value="Generate Cat?" onclick="catAPIfetch()">
            <div id="cat"></div>
            <div id="catInfo"></div>
            <p>Image sourced from <a href="https://api.thecatapi.com">api.thecatapi.com</a></p>
            <script>
                async function catAPIfetch(){
                    const catAPI_res = await
                    fetch("https://api.thecatapi.com/v1/images/search?api_key=live_oHh2GI6I4zpgQfYxxHLSmnIlde13K2opgrDTx0UxLOP9BoC9mCueV57PCKc32gum");
                    const result = await catAPI_res.json();
                    const catUrl = result[0].url;
                    const catWidth = result[0].width;
                    const catHeight = result[0].height;
                    $("#cat").html(`<img src="${catUrl}" class="img-responsive margin" style="display:inline" alt="Cat" width="${catWidth}" height="${catHeight}">`);
                }
            </script>
        </div>
        
        <!-- Chat Bot -->
        <div class="container-fluid bg-3 text-center">
            <h1 class="margin">Gemini Chat Bot</h1>
            <div id="chatBox"></div>
            <input type="text" id="userInput" placeholder="Type a message...">
            <input class="button round" type="button" id="sendButton" value="Send">
            <script>
                window.conversationHistory = [];
                async function messageSend(userMessage){
                    window.conversationHistory.push({ role: "user", text: userMessage });

                    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyAMhS826aM-vddEHm7AsxVMW-cX0w1Z5xM`;
                    

                    messageDisplay(userMessage, "user");

                    $("#chatBox").append(`<div class="message waiting">Thinking...</div>`);

                    const response = await fetch(url, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ 
                            contents: [{ 
                                role: "user", 
                                parts: [{ 
                                    text: userMessage
                                }] 
                            }] 
                        }),
                    });

                    const data = await response.json();
                    $(".waiting").remove();

                    if (data && data.candidates && data.candidates.length > 0) {
                        const botMessage = data.candidates[0]?.content?.parts?.[0]?.text;
                        window.conversationHistory.push({ role: "bot", text: botMessage });
                        messageDisplay(botMessage, "bot");
                    } else {
                        messageDisplay("Sorry, I couldn't understand that.", "bot");
                    }
                }
                async function messageDisplay(message, sender){
                    const chatBox = $("#chatBox");
                    const messageClass = sender === "user" ? "user-message" : "bot-message";
                    chatBox.append(`<div class="message ${messageClass}">${message}</div>`);
                }
                $("#sendButton").click(function () {
                    const userMessage = $("#userInput").val();
                    if (!userMessage.trim()) return; // Ignore empty messages
                    messageSend(userMessage);
                    $("#userInput").val(""); // Clear input
                });
            </script>
        </div>
        
        <!-- Footer -->
        <footer class="container-fluid bg-4 text-center">
        <p>Bootstrap Theme Made By <a href="https://www.w3schools.com">www.w3schools.com</a></p> 
        </footer>
    </body>
    <a href="https://info.flagcounter.com/eI2o"><img src="https://s01.flagcounter.com/count2_US/eI2o/bg_D1FFD1/txt_224B22/border_D1FFD1/columns_4/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>
</html>